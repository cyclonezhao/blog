---
layout: post
title:  多级索引
date:   2019-04-14 23:34:00:00 +0800
tags:
  - 数据库理论
categories:
  - 软件开发
mathjax: true
---

# 多级索引

对于占有$b_i$个块的索引文件，二分查找大约需要 $\log _2 b_i$ 次块访问，多级索引可以减少块访问次数。

将索引文件作为多级索引的**第一级**，然后，对第一级建立主索引，该主索引作为多级索引的**第二级**，索引项的数目等于第一级的块数。因为第二级是主索引，所以可以使用块锚。索引文件的块因子 $(bfr_i)$ 又称作多级索引的扇出$(fo)$。若索引文件有$r_1$个项，则第二级则有 $r_2=\lceil (r_1/fo) \rceil$ 个项。

对第二级可重复这一过程，得到**第三级**，第三级拥有$r_3=\lceil (r_2/fo) \rceil$个项。

只有当第一级所需要的存储空间超过一个块时，才需要第二级。类似地，只有当第二级所需要的存储空间超过一个块时，才需要第三级。重复这个过程直到第t级索引所需要的存储空间在一个块以内，该磁盘块称为**顶级索引**，其中 $t=\lceil \log _fo (r1) \rceil$ 。

以上多级索引模式使用于任何索引类型，但要求第一级索引对K(i)的取值唯一，并且项定长。

## 多级索引如何减少块访问

回顾{% post_link 索引基础 索引基础 %}中的例子3，如果把其中的辅助稠密索引换成多级索引，首先已知 $fo=bfr_i=68$，第一级的块数 $b_1=442$，则 $b_2=\lceil 442/68 \rceil=7$，$b_3=\lceil 7/68 \rceil=1$，因此t=3。通过搜索多级索引访问记录，需要在每一级上进行一次块访问，另外还需要访问一次数据块，因此总共需要 3+1=4 次块访问，而例子3的单级索引需要 10 次块访问。